네, 제공해주신 Cybos Plus의 `StockChart` API 명세서를 LLM이 이해하고 활용하기 좋은 Markdown 형식으로 재구성해 드리겠습니다.

---

# API 명세서: StockChart

## 1. 개요

`StockChart`는 주식, 업종, ELW의 과거 및 현재 차트 데이터를 조회하기 위한 COM 객체입니다. 일, 주, 월, 분, 틱 단위의 시계열 데이터를 요청하고 수신할 수 있습니다.

-   **주요 기능**: 특정 종목의 OHLCV(시가, 고가, 저가, 종가, 거래량) 등 다양한 차트 관련 데이터 조회
-   **관련 CYBOS 화면**: [7400 통합챠트]
-   **모듈 위치**: `cpsysdib.dll`

## 2. 통신 방식

-   **통신 종류**: Request/Reply
-   **연속 데이터 여부**: 연속적이지 않음 (X)

## 3. Methods

### 3.1. `object.SetInputValue(type, value)`

데이터 요청에 필요한 입력 값을 설정합니다.

| `type` | 입력 데이터 종류 | `value` 데이터 타입 | 설명 |
| :--- | :--- | :--- | :--- |
| **0** | **종목코드** | `string` | 주식(예: "A003540"), 업종(예: "U001"), ELW(예: "J517016")의 종목코드 |
| **1** | **요청 구분** | `char` | '1' (기간으로 요청) 또는 '2' (개수로 요청) |
| **2** | **요청 종료일** | `ulong` | YYYYMMDD 형식의 데이터 마지막 날짜. 기본값(0)은 최근 거래일. |
| **3** | **요청 시작일** | `ulong` | YYYYMMDD 형식의 데이터 시작 날짜. |
| **4** | **요청 개수** | `ulong` | 요청할 데이터의 개수(봉 기준). |
| **5** | **필드** | `long` or `long array` | 요청할 데이터 필드의 값 또는 값의 배열. (상세 내용은 아래 **필드 상세** 참고) |
| **6** | **차트 구분** | `char` | 'D'(일), 'W'(주), 'M'(월), 'm'(분), 'T'(틱). |
| **7** | **주기** | `ushort` | 분, 틱 차트의 주기. 기본값은 1. |
| **8** | **갭 보정 여부** | `char` | '0'(무보정, Default), '1'(갭 보정). |
| **9** | **수정 주가** | `char` | '0'(무수정주가, Default), '1'(수정주가). |
| **10** | **거래량 구분** | `char` | '1'(시간외 포함, Default), '2'(장종료 시간외만 포함), '3'(시간외 모두 제외), '4'(장전 시간외만 포함) |

---

### 3.2. `object.Request()` / `object.BlockRequest()`

설정된 입력 값을 기반으로 서버에 차트 데이터를 요청합니다.

-   `object.Request()`: Non-blocking 방식으로 데이터를 요청합니다. 결과는 `Received` 이벤트로 수신됩니다.
-   `object.BlockRequest()`: Blocking 방식으로 데이터를 요청합니다. 데이터 수신이 완료될 때까지 다음 코드가 실행되지 않습니다.

---

### 3.3. `object.GetHeaderValue(type)`

요청에 대한 응답으로 받은 헤더(Header) 데이터를 반환합니다.

| `type` | 헤더 데이터 종류 | 반환 데이터 타입 | 설명 |
| :--- | :--- | :--- | :--- |
| **0** | **종목코드** | `string` | 수신된 데이터의 종목코드 |
| **1** | **필드 개수** | `short` | 요청한 필드의 총 개수 |
| **2** | **필드명 배열** | `string array` | 요청한 필드명의 배열 (오름차순 정렬) |
| **3** | **수신 개수** | `long` | 수신된 데이터(봉)의 개수 |
| **4** | **마지막 봉 틱수** | `ushort` | |
| **5** | **최근 거래일** | `ulong` | YYYYMMDD 형식 |
| **6** | **전일 종가** | `ulong` or `float` | |
| **7** | **현재가** | `ulong` or `float` | |
| **8** | **대비 부호** | `char` | (상세 내용은 아래 **대비 부호 상세** 참고) |
| **9** | **대비** | `long` or `float` | 전일 대비 가격 변동폭 |
| **10** | **거래량** | `ulong` or `ulonglong`| |
| **11** | **매도 호가** | `ulong` or `float` | |
| **12** | **매수 호가** | `ulong` or `float` | |
| **13** | **시가** | `ulong` or `float` | |
| **14** | **고가** | `ulong` or `float` | |
| **15** | **저가** | `ulong` or `float` | |
| **16** | **거래 대금** | `ulonglong` | |
| **17** | **종목 상태** | `char` | (상세 내용은 아래 **종목 상태 상세** 참고) |
| **18** | **상장 주식 수**| `ulonglong` | |
| **19** | **자본금** | `ulong` | 단위: 백만원 |
| **20** | **전일 거래량** | `ulong` or `ulonglong` | |
| **21** | **최근 갱신 시간**| `ulong` | hhmm 형식 |
| **22** | **상한가** | `ulong` or `float` | |
| **23** | **하한가** | `ulong` or `float` | |

---

### 3.4. `object.GetDataValue(Type, index)`

수신된 상세 데이터를 인덱스로 조회합니다. `BlockRequest` 또는 `Received` 이벤트 내에서 사용됩니다.

-   `Type`: 요청한 필드의 인덱스. `GetHeaderValue(2)`로 받은 필드명 배열의 순서와 동일합니다.
-   `index`: 요청한 데이터(봉)의 인덱스. 0부터 `GetHeaderValue(3) - 1` 까지의 값을 가집니다.

---

### 3.5. `object.Subscribe()` / `object.Unsubscribe()`

`StockChart` 객체에서는 사용하지 않습니다.

## 4. Events

### 4.1. `Object.Received`

`object.Request()`를 통해 요청한 데이터 수신이 완료되었을 때 발생하는 이벤트입니다.

## 5. 상세 코드 정보

### 5.1. 필드 상세 (`SetInputValue`, type 5)

| 필드값 | 내용 | 데이터 타입 | 비고 |
| :--- | :--- | :--- | :--- |
| **0** | 날짜 | `ulong` | YYYYMMDD |
| **1** | 시간 | `long` | hhmm |
| **2** | 시가 | `long` or `float` | |
| **3** | 고가 | `long` or `float` | |
| **4** | 저가 | `long` or `float` | |
| **5** | 종가 | `long` or `float` | |
| **6** | 전일 대비 | `long` or `float` | 필드 37(대비부호)과 함께 요청해야 함 |
| **8** | 거래량 | `ulong` or `ulonglong`| 정밀도: 만원 단위 |
| **9** | 거래대금 | `ulonglong` | |
| **10** | 누적체결매도수량 | `ulong` or `ulonglong`| 분/틱 요청 시에만 제공 |
| **11** | 누적체결매수수량 | `ulong` or `ulonglong`| 분/틱 요청 시에만 제공 |
| **12** | 상장주식수 | `ulonglong` | |
| **13** | 시가총액 | `ulonglong` | |
| **14** | 외국인주문한도수량 | `ulong` | |
| **15** | 외국인주문가능수량 | `ulong` | |
| **16** | 외국인현보유수량 | `ulong` | |
| **17** | 외국인현보유비율 | `float` | |
| **18** | 수정주가일자 | `ulong` | YYYYMMDD |
| **19** | 수정주가비율 | `float` | |
| **20** | 기관순매수 | `long` | |
| **21** | 기관누적순매수 | `long` | |
| **22** | 등락주선 | `long` | |
| **23** | 등락비율 | `float` | |
| **24** | 예탁금 | `ulonglong` | |
| **25** | 주식회전율 | `float` | |
| **26** | 거래성립률 | `float` | |
| **37** | 대비부호 | `char` | |

### 5.2. 대비 부호 상세 (`GetHeaderValue`, type 8)

| 코드 | 내용 |
| :--- | :--- |
| **'1'** | 상한 |
| **'2'** | 상승 |
| **'3'** | 보합 |
| **'4'** | 하한 |
| **'5'** | 하락 |
| **'6'** | 기세상한 |
| **'7'** | 기세상승 |
| **'8'** | 기세하한 |
| **'9'** | 기세하락 |

### 5.3. 종목 상태 상세 (`GetHeaderValue`, type 17)

| 코드 | 내용 | 코드 | 내용 |
| :--- | :--- | :--- | :--- |
| **'0'** | 정상 | **'F'** | 불성실공시&투자위험예고 |
| **'1'** | 투자위험 | **'G'** | 불성실공시&투자주의 |
| **'2'** | 관리 | **'H'** | 불성실공시&투자경고 |
| **'3'** | 거래정지 | **'I'** | 투자위험예고&거래정지 |
| **'4'** | 불성실공시 | **'J'** | 투자주의&거래정지 |
| **'5'** | 불성실공시&관리 | **'K'** | 투자경고&거래정지 |
| **'6'** | 불성실공시&거래정지 | **'L'** | 불성실공시&투자위험예고&거래정지 |
| **'7'** | 불성실공시&투자위험 | **'M'** | 불성실공시&투자주의&거래정지 |
| **'8'** | 투자위험&거래정지 | **'N'** | 불성실공시&투자경고&거래정지 |
| **'9'** | 관리&거래정지 | **'Z'** | ETF종목 |
| **'A'** | 불성실공시&관리&거래정지 | | |
| **'B'** | 불성실공시&투자위험&거래정지 | | |
| **'C'** | 투자위험예고 | | |
| **'D'** | 투자주의 | | |
| **'E'** | 투자경고 | | |